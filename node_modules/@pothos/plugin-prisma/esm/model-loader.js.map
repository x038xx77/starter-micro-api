{"version":3,"sources":["../src/model-loader.ts"],"names":["createContextCache","getDelegateFromModel","getModel","getClient","mergeSelection","selectionCompatible","selectionToQuery","ModelLoader","forRef","ref","modelName","findUnique","builder","model","Error","name","getDefaultFindUnique","getFindUnique","findBy","parent","fields","primaryKeyName","primaryKey","key","join","getDefaultFindBy","idField","find","field","isId","uniqueField","isRequired","isUnique","uniqueIndex","uniqueIndexes","idx","every","f","getDefaultIDSelection","result","getCursorSelection","cursor","index","filter","Boolean","selection","column","getFindUniqueForField","fieldName","some","loadSelection","context","query","entry","staged","state","promise","initLoad","Promise","resolve","then","delete","delegate","findUniqueOrThrow","where","rejectOnNotFound","add","constructor","Set"],"mappings":"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"}